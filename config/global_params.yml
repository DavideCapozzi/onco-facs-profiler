# ==============================================================================
# PROJECT CONFIGURATION: CLR Network Inference
# ==============================================================================

# --- Setup ---
output_root: "results"
project_name: "longsurvivors"
input_file: "/mnt/c/Users/Davide/Desktop/Davide/bandi/0dottorato/projects/long survivors/DB_standardizzatov4.xlsx"

# --- ANALYSIS TARGETS (Single Source of Truth) ---
# Define here exactly which groups you want to analyze and color.
# If using stratification (see below), use the suffixed names (e.g., "NSCLC_LS").
control_group: "Healthy"
case_groups: ["NSCLC_LS", "NSCLC_Std", "HNSCC_LS", "HNSCC_Std"]  # Dynamic: Add/Remove groups here. 

# --- STRATIFICATION LOGIC ---
# How to build the group labels from metadata?
stratification:
  mode: "stratified_ls"         # Options: "original" (no change), "stratified_ls" (split by pattern), "binary" (Control vs Case)
  column: "Original_Source"     # Metadata column to check
  pattern: "_LS"                # Pattern to identify the subgroup
  suffix_match: "_LS"           # Suffix for matching samples
  suffix_no_match: "_Std"       # Suffix for non-matching samples

# --- COHORTS MAPPING ---
cohorts:
  NSCLC: "NSCLC"
  HNSCC: "HNSCC"
  Healthy: "Healthy_Donors"

marker_selection:
  whitelist: []      
  blacklist: [] 

hybrid_groups:
  Differentiation: ["CM", "EFF", "EM", "NAIVE"]
  Lineage: ["CD4", "CD8"]  
  Treg_Status: ["RESTING", "ACTIVE", "NON-SUPPRESSIVE"]
  
metadata:
  subgroup_col: "Original_Source"

# --- VISUALS & COLORS ---
# Qui definisci i colori per TUTTI i possibili nomi (Sia Macro che Micro).
# Cos√¨ Step 2 trova "NSCLC" e Step 3 trova "NSCLC_LS".
colors:
  control: "#2E8B57"         # Healthy
  Case: "#B22222"

  # Definiamo colori espliciti per evitare confusioni
  groups:
    # Gruppi MACRO (Per Step 2 - Distribuzioni Unite)
    NSCLC: "#CD5C5C"         # Rosso Indiano
    HNSCC: "#4682B4"         # Blu Acciaio
    
    # Gruppi MICRO (Per Step 3/4 - Se vuoi colori specifici, altrimenti eredita)
    NSCLC_LS: "#B22222"      # Rosso Scuro (Firebrick)
    NSCLC_Std: "#FA8072"     # Rosso Chiaro (Salmon)
    HNSCC_LS: "#000080"      # Blu Scuro (Navy)
    HNSCC_Std: "#87CEFA"     # Blu Chiaro (LightSkyBlue)

  # Palette di riserva (lasciala per sicurezza)
  cases: ["#CD5C5C", "#4682B4", "#9932CC", "#FF8C00"] 
  
  highlight: "#FFD700"       # Oro (Per i punti LS nello Step 2)

# # Colors are applied dynamically to the groups defined in 'case_groups' above.
# colors:
#   control: "#2E8B57"         # SeaGreen (Always assigned to control_group)
#   # The palette below is assigned in order to the groups in 'case_groups'
#   cases: ["#CD5C5C", "#4682B4", "#9932CC", "#FF8C00"]  
#  highlight: "#FFD700"       # Gold (for specific highlighting if needed)

  heatmap:
    low: "#2166AC"    
    mid: "#F7F7F7"    
    high: "#B2182B"   
  
  plsda:
    positive: "#CD5C5C" 
    negative: "#4682B4" 
    
  distribution:
    mean: "darkred"
    median: "black"

viz:
  min_edge_weight: 0.15 
  heatmap_metadata: ["Group", "Original_Source"]
  merge_case_groups: false
  highlight_pattern: "_LS"

# --- Quality Control ---
qc:
  max_na_row_pct: 0.55   
  max_na_col_pct: 0.20  
  remove_outliers: true
  outlier_conf_level: 0.99 

# --- Imputation (CoDa) ---
imputation:
  method: "czm_multrepl"      

# --- Multivariate & Interpretation ---
multivariate:
  run_plsda: true
  n_comp: 2           
  validation_folds: 5 
  top_n_loadings: 15  

# --- Inference Statistics ---
stats:
  seed: 2025
  n_boot: 1000        
  n_perm: 2000        
  alpha: 0.05         
  fdr_threshold: 0.1 
  n_cores: "auto"
